# Relat√≥rio de Vulnerabilidades de Seguran√ßa da Aplica√ß√£o

Este relat√≥rio resume as vulnerabilidades encontradas em uma aplica√ß√£o, utilizando dados das ferramentas Snyk, Semgrep, Gitleaks, Bandit e OWASP Dependency-Check.  O relat√≥rio do Dependency-Check indica 16 vulnerabilidades, mas os logs n√£o cont√™m detalhes espec√≠ficos. As vulnerabilidades detalhadas abaixo s√£o provenientes do Semgrep, Gitleaks e Bandit.

## Vulnerabilidades detectadas pelo Semgrep

O Semgrep reportou 15 vulnerabilidades.

### üü† Alta Severidade

- **Descri√ß√£o:** Chamadas √† fun√ß√£o `child_process` com argumento `filename` control√°vel pelo usu√°rio em `/src/vulnerable-code.js`, linha 20. Isso pode levar a inje√ß√£o de comandos.
- **Arquivo e Linha:** `/src/vulnerable-code.js:20`
- **Sugest√£o de Corre√ß√£o:** Evite chamar `child_process`. Se necess√°rio, sanitize ou isole o input do usu√°rio antes de us√°-lo.

- **Descri√ß√£o:** A aplica√ß√£o Flask est√° sendo executada com `debug=True` e `host='0.0.0.0'` em `/src/vulnerable-code.py`, linha 72. Isso exp√µe o servidor publicamente e possibilita a execu√ß√£o de c√≥digo arbitr√°rio atrav√©s do debugger.
- **Arquivo e Linha:** `/src/vulnerable-code.py:72`
- **Sugest√£o de Corre√ß√£o:**  N√£o utilize `debug=True` em produ√ß√£o. Use vari√°veis de configura√ß√£o do Flask ou vari√°veis de ambiente para configurar o modo de depura√ß√£o. Configure o `host` para restringir o acesso.

### üü° M√©dia Severidade

- **Descri√ß√£o:** Uso de `eval()` em `/src/vulnerable-code.js`, linha 36 e `/src/vulnerable-code.py`, linha 68. `eval()` √© perigoso se usado para avaliar conte√∫do din√¢mico control√°vel pelo usu√°rio, possibilitando inje√ß√£o de c√≥digo.
- **Arquivo e Linha:** `/src/vulnerable-code.js:36`, `/src/vulnerable-code.py:68`
- **Sugest√£o de Corre√ß√£o:** Certifique-se de que o conte√∫do avaliado n√£o seja definido por fontes externas. Utilize alternativas mais seguras, como `JSON.parse()` no Javascript e `ast.literal_eval()` em Python, para avaliar dados confi√°veis.

- **Descri√ß√£o:**  MD5 usado como hash de senha em `/src/vulnerable-code.js`, linha 42 e `/src/vulnerable-code.py`, linha 39. MD5 √© criptograficamente fraco.
- **Arquivo e Linha:** `/src/vulnerable-code.js:42`, `/src/vulnerable-code.py:39`
- **Sugest√£o de Corre√ß√£o:** Utilize uma fun√ß√£o de hash de senha mais robusta, como bcrypt (Javascript) ou scrypt (Python).

- **Descri√ß√£o:** Consulta SQL formatada em `/src/vulnerable-code.py`, linha 19, vulner√°vel a inje√ß√£o de SQL.
- **Arquivo e Linha:** `/src/vulnerable-code.py:19`
- **Sugest√£o de Corre√ß√£o:** Utilize consultas parametrizadas para prevenir inje√ß√£o de SQL.

- **Descri√ß√£o:** Elemento com escape HTML desabilitado detectado em `/src/reports/dependency-check-report.html`, linha 10. Se dados externos alcan√ßarem este elemento, isso √© uma vulnerabilidade XSS.
- **Arquivo e Linha:** `/src/reports/dependency-check-report.html:10`
- **Sugest√£o de Corre√ß√£o:** Certifique-se de que nenhum dado externo possa alcan√ßar este elemento ou remova `escape=false`.

- **Descri√ß√£o:** Uso de `pickle.loads()` em `/src/vulnerable-code.py`, linha 34. O `pickle` √© conhecido por levar a vulnerabilidades de execu√ß√£o de c√≥digo.
- **Arquivo e Linha:** `/src/vulnerable-code.py:34`
- **Sugest√£o de Corre√ß√£o:** Considere serializar os dados relevantes como JSON ou um formato de serializa√ß√£o baseado em texto similar.


### üîµ Baixa Severidade

- **Descri√ß√£o:** Dados controlados pelo usu√°rio em m√©todos como `innerHTML`, `outerHTML` ou `document.write` em `/src/vulnerable-code.js`, linha 11. Isso pode levar a vulnerabilidades XSS.
- **Arquivo e Linha:** `/src/vulnerable-code.js:11`
- **Sugest√£o de Corre√ß√£o:** Utilize m√©todos de manipula√ß√£o de DOM seguros e sanitize  o conte√∫do antes da inser√ß√£o.

- **Descri√ß√£o:** Gera√ß√£o de n√∫meros pseudo-aleat√≥rios com `random.randint` em `/src/vulnerable-code.py`, linha 44. Geradores pseudo-aleat√≥rios padr√µes n√£o s√£o adequados para fins de seguran√ßa/criptografia.
- **Arquivo e Linha:** `/src/vulnerable-code.py:44`
- **Sugest√£o de Corre√ß√£o:** Utilize um gerador de n√∫meros aleat√≥rios criptograficamente seguro.

- **Descri√ß√£o:** `assert` usado em `/src/vulnerable-code.py`, linha 62. O `assert` pode ser desabilitado em produ√ß√£o.
- **Arquivo e Linha:** `/src/vulnerable-code.py:62`
- **Sugest√£o de Corre√ß√£o:**  N√£o utilize `assert` para valida√ß√£o de seguran√ßa.  Implemente mecanismos de autentica√ß√£o e autoriza√ß√£o mais robustos.

- **Descri√ß√£o:** Chamada √† fun√ß√£o `open()` com dados de requisi√ß√£o em `/src/vulnerable-code.py`, linha 51. Isso pode levar a ataques de path traversal.
- **Arquivo e Linha:** `/src/vulnerable-code.py:51`
- **Sugest√£o de Corre√ß√£o:** Valide ou sanitize os dados de requisi√ß√£o antes de us√°-los na fun√ß√£o `open()`.


## Vulnerabilidades detectadas pelo Gitleaks

O Gitleaks detectou 6 vazamentos de segredos.

### üö® Cr√≠tica Severidade

- **Descri√ß√£o:**  V√°rias chaves de API foram encontradas em `/path/.env` (linhas 1, 2 e 3) e `/path/test-secrets.js` (linha 18) e `/path/vulnerable-code.js` (linha 15 e linha 9).
- **Arquivo e Linha:** `/path/.env:1,2,3`, `/path/test-secrets.js:18`, `/path/vulnerable-code.js:15,9`
- **Sugest√£o de Corre√ß√£o:**  Remova imediatamente as chaves de API do reposit√≥rio de c√≥digo. Utilize gerenciadores de segredos para armazenar e gerenciar informa√ß√µes sens√≠veis.

## Vulnerabilidades detectadas pelo Bandit

O Bandit identificou 12 vulnerabilidades em `./vulnerable-code.py`.

### üü† Alta Severidade

- **Descri√ß√£o:**  Uso de `subprocess.call(cmd, shell=True)` em `/src/vulnerable-code.py`, linha 57. Isso √© vulner√°vel a inje√ß√£o de comandos.
- **Arquivo e Linha:** `/src/vulnerable-code.py:57`
- **Sugest√£o de Corre√ß√£o:** Use `shell=False` e passe a lista de argumentos corretamente.

- **Descri√ß√£o:** A aplica√ß√£o Flask est√° sendo executada com `debug=True` em `/src/vulnerable-code.py`, linha 72. Isso exp√µe o debugger Werkzeug.
- **Arquivo e Linha:** `/src/vulnerable-code.py:72`
- **Sugest√£o de Corre√ß√£o:** N√£o utilize `debug=True` em produ√ß√£o. Utilize vari√°veis de configura√ß√£o ou ambiente.


- **Descri√ß√£o:** Constru√ß√£o de query SQL atrav√©s de concatena√ß√£o de strings em `/src/vulnerable-code.py`, linha 18. Vulner√°vel a inje√ß√£o de SQL.
- **Arquivo e Linha:** `/src/vulnerable-code.py:18`
- **Sugest√£o de Corre√ß√£o:** Utilize consultas parametrizadas.

### üü° M√©dia Severidade

- **Descri√ß√£o:** Uso de `pickle.loads()` em `/src/vulnerable-code.py`, linha 34. Vulner√°vel a desserializa√ß√£o insegura.
- **Arquivo e Linha:** `/src/vulnerable-code.py:34`
- **Sugest√£o de Corre√ß√£o:** Utilize um m√©todo de serializa√ß√£o mais seguro, como JSON.

- **Descri√ß√£o:** Uso de MD5 para hash de senha em `/src/vulnerable-code.py`, linha 39. MD5 √© criptograficamente fraco.
- **Arquivo e Linha:** `/src/vulnerable-code.py:39`
- **Sugest√£o de Corre√ß√£o:** Utilize uma fun√ß√£o de hash de senha mais robusta.

- **Descri√ß√£o:**  Uso da fun√ß√£o `os.system` em `/src/vulnerable-code.py`, linha 25, que √© vulner√°vel a inje√ß√£o de comandos.
- **Arquivo e Linha:** `/src/vulnerable-code.py:25`
- **Sugest√£o de Corre√ß√£o:** Utilize `subprocess` com `shell=False` ou m√©todos mais seguros para executar comandos externos.


### üîµ Baixa Severidade

- **Descri√ß√£o:** Importa√ß√µes inseguras de m√≥dulos `subprocess` e `pickle` em `/src/vulnerable-code.py`, linhas 4 e 6.
- **Arquivo e Linha:** `/src/vulnerable-code.py:4,6`
- **Sugest√£o de Corre√ß√£o:** Avalie se a utiliza√ß√£o destes m√≥dulos √© estritamente necess√°ria e se existem alternativas mais seguras.

- **Descri√ß√£o:** Senhas codificadas em hardcode em `/src/vulnerable-code.py`, linhas 28 e 29.
- **Arquivo e Linha:** `/src/vulnerable-code.py:28,29`
- **Sugest√£o de Corre√ß√£o:** Utilize um sistema de gerenciamento de senhas seguro e armazene senhas de forma criptografada.

- **Descri√ß√£o:**  Uso de gerador pseudo-aleat√≥rio `random.randint` em `/src/vulnerable-code.py`, linha 44.
- **Arquivo e Linha:** `/src/vulnerable-code.py:44`
- **Sugest√£o de Corre√ß√£o:** Utilize um gerador de n√∫meros aleat√≥rios criptograficamente seguro.

- **Descri√ß√£o:** Uso de `assert` em `/src/vulnerable-code.py`, linha 62, que pode ser desabilitado em produ√ß√£o.
- **Arquivo e Linha:** `/src/vulnerable-code.py:62`
- **Sugest√£o de Corre√ß√£o:** N√£o utilize `assert` para valida√ß√£o de seguran√ßa.  Implemente mecanismos de autentica√ß√£o e autoriza√ß√£o mais robustos.

- **Descri√ß√£o:** Liga√ß√£o a todas as interfaces (`host='0.0.0.0'`) em `/src/vulnerable-code.py`, linha 72.
- **Arquivo e Linha:** `/src/vulnerable-code.py:72`
- **Sugest√£o de Corre√ß√£o:** Especifique o host para restringir o acesso.



**Nota:** O log do Snyk apresentou um erro ("socket hang up"). √â necess√°rio investigar e executar novamente a an√°lise.  A an√°lise de depend√™ncias do OWASP Dependency-Check precisa de logs adicionais para detalhar as vulnerabilidades relatadas.


Este relat√≥rio fornece uma vis√£o geral das vulnerabilidades encontradas.  A prioriza√ß√£o e resolu√ß√£o das vulnerabilidades devem ser conduzidas com base na avalia√ß√£o de risco e na criticidade da aplica√ß√£o.
